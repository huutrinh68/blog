(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{563:function(n,a,s){"use strict";s.r(a);var e=s(8),t=Object(e.a)({},(function(){var n=this,a=n.$createElement,s=n._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[s("p",[n._v("Trong bÃ i nÃ y sáº½ hÆ°á»›ng dáº«n cÃ¡ch xÃ³a log trong container")]),n._v(" "),s("p",[n._v("Khi sá»­ dá»¥ng docker trÃªn server, service tá»± nhiÃªn má»™t ngÃ y Ä‘áº¹p trá»i khÃ´ng hoáº¡t Ä‘á»™ng,\nlÃºc Ä‘Ã³ kiá»ƒm tra há»‡ thá»‘ng thÃ¬ ta tháº¥y dung lÆ°á»£ng cá»§a á»• cá»©ng Ä‘Ã£ khÃ´ng cÃ²n ná»¯a.\nVÃ  lÃ½ do lÃ  do lÆ°á»£ng log quÃ¡ lá»›n mÃ  container sinh ra tÃ­ch tá»¥ tá»« ráº¥t lÃ¢u rá»“i.")]),n._v(" "),s("p",[n._v("Khi Ä‘Ã³ cÃ¡ch giáº£i quyáº¿t sáº½ nhÆ° sau:")]),n._v(" "),s("ul",[s("li",[n._v("XÃ¡c Ä‘á»‹nh vá»‹ trÃ­ cá»§a file log")]),n._v(" "),s("li",[n._v("XÃ³a ná»™i dung file log")]),n._v(" "),s("li",[n._v("Ãp dá»¥ng thÃªm logging rotation vÃ o Ä‘á»ƒ log khÃ´ng bá»‹ tÃ­ch tá»¥ mÃ  sáº½ tá»± xÃ³a khi quÃ¡ giá»›i háº¡n")])]),n._v(" "),s("h3",{attrs:{id:"xoa-log-cua-container"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#xoa-log-cua-container"}},[n._v("#")]),n._v(" XÃ³a log cá»§a container")]),n._v(" "),s("p",[n._v("CÃ¡ch Ä‘á»ƒ xÃ¡c Ä‘á»‹nh cá»§a log")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("$ docker inspect [container name] | grep -i log\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br")])]),s("p",[n._v("Náº¿u trÃªn linux server thÃ¬ vá»‹ trÃ­ thÆ°á»ng lÃ  bÃªn dÆ°á»›i "),s("code",[n._v("/var/lib/docker/containers/xxx-json.log")])]),n._v(" "),s("h3",{attrs:{id:"xoa-noi-dung-cua-file-log"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#xoa-noi-dung-cua-file-log"}},[n._v("#")]),n._v(" XÃ³a ná»™i dung cá»§a file log")]),n._v(" "),s("p",[n._v("DÃ¹ng lá»‡nh dÆ°á»›i Ä‘á»ƒ xÃ³a")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("$ sudo truncate -s 0 /var/lib/docker/containers/xxx-json.log\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br")])]),s("h3",{attrs:{id:"tao-logging-rotate-cho-docker-container"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tao-logging-rotate-cho-docker-container"}},[n._v("#")]),n._v(" Táº¡o logging rotate cho docker container")]),n._v(" "),s("p",[n._v("BÃªn trong service cá»§a docker-compose ta thÃªm Ä‘oáº¡n setting sau:")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("logging:\n  driver: 'json-file'\n  options:\n    max-size: '10m'\n    max-file: '3'\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br")])]),s("p",[n._v("á» Ä‘Ã¢y Ä‘ang vÃ­ dá»¥ lÃ  cá»© 10Mb thÃ¬ file log sáº½ Ä‘Æ°á»£c tÃ¡ch ra, vÃ  tá»‘i Ä‘a lÃ  cÃ³ 3 files nhÆ° váº­y lÃ  30Mb log tá»‘i Ä‘a.\nDo lÃ  options nÃªn cÃ¡c thÃ´ng sá»‘ trÃªn cÃ³ thá»ƒ thay Ä‘á»•i tÃ¹y thÃ­ch\nSau Ä‘Ã³ restart láº¡i cÃ¡c service")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("$ docker-compose restart\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br")])]),s("h3",{attrs:{id:"setting-global"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#setting-global"}},[n._v("#")]),n._v(" Setting global")]),n._v(" "),s("p",[n._v("CÃ²n má»™t cÃ¡ch setting ná»¯a sáº½ setting cho toÃ n bá»™ docker container chá»© khÃ´ng cáº§n vÃ o docker-compose Ä‘á»ƒ setting cho tá»«ng service.")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("$ sudo vim /etc/docker/daemin.json\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br")])]),s("p",[n._v("ThÃªm vÃ o thÃ´ng tin dÆ°á»›i Ä‘Ã¢y")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v('{\n   "log-driver": "json-file",\n   "log-opts": {"max-size": "10m", "max-file": "3"}\n}\n')])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br")])]),s("p",[n._v("LÆ°u setting trÃªn láº¡i vÃ  kiá»ƒm tra báº±ng lá»‡nh")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v('$ sudo cat /etc/docker/daemin.json\n{\n   "log-driver": "json-file",\n   "log-opts": {"max-size": "10m", "max-file": "3"}\n}\n')])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br")])]),s("p",[n._v("DÃ¹ng cÃ¡ch nÃ y chÃºng ta pháº£i restart cáº£ docker service Ä‘á»ƒ load láº¡i config cho docker")]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("$ docker-compose stop\n$ sudo systemctl restart docker\n$ docker-compose restart\n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br")])]),s("p",[n._v("ğŸº ğŸº ğŸº Okie Ä‘Ã£ xong vÃ  yÃªn tÃ¢m viá»‡c khÃ´ng bá»‹ file log lÃ m trÃ n dung lÆ°á»£ng ná»¯a!")])])}),[],!1,null,null,null);a.default=t.exports}}]);